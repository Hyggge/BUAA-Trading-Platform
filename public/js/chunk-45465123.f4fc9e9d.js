(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45465123"],{"5f3b":function(e,t,a){"use strict";var l=a("aea8"),s=a("cde5").trim,n=a("ab15");l({target:"String",proto:!0,forced:n("trim")},{trim:function(){return s(this)}})},9207:function(e,t,a){"use strict";a.r(t);a("2832"),a("2482"),a("5f3b");var l=function(){var e=this,t=e._self._c;return t("d2-container",{scopedSlots:e._u([{key:"header",fn:function(){return[t("el-row",[t("el-col",{staticStyle:{"text-align":"center"}},[t("el-avatar",{staticStyle:{"margin-left":"10px"},attrs:{size:150,src:e.headImg}})],1)],1),t("el-row",[t("el-col",{staticStyle:{"text-align":"center"}},[t("h2",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.auth.username))])]),t("el-col",{staticStyle:{"margin-top":"-30px"},attrs:{span:3,offset:19}},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.openFormForUpdate}},[e._v("个人信息修改")])],1),t("el-col",{staticStyle:{"margin-top":"-30px"},attrs:{span:3,offset:22}},[t("el-upload",{staticClass:"upload-demo",staticStyle:{width:"100%"},attrs:{headers:{Authorization:"Bearer "+e.token},"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,"before-upload":e.beforeImageUpload,"show-file-list":!1,action:"/api/images"}},[t("el-button",{attrs:{size:"mini",type:"success"}},[e._v("上传新头像")])],1)],1)],1)]},proxy:!0}])},[t("el-collapse",{attrs:{value:["1","2"]}},[t("el-collapse-item",{attrs:{title:"基本信息",name:"1"}},[t("el-descriptions",{staticClass:"margin-top",attrs:{column:2,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" 用户名 ")]),e._v(" "+e._s(e.userInfo.username)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-location-outline"}),e._v(" 身份 ")]),e._v(" "+e._s(0==e.userInfo.role?"管理员":"普通用户")+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-location-outline"}),e._v(" 居住地 ")]),e._v(" 北京市 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 手机号 ")]),e._v(" "+e._s(e.userInfo.phone_no)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-message"}),e._v(" 电子邮箱 ")]),e._v(" "+e._s(e.userInfo.email)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-watch"}),e._v(" 注册时间 ")]),e._v(" "+e._s(e.userInfo.reg_time.slice(0,e.userInfo.reg_time.indexOf("T")))+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 个性签名 ")]),e._v(" "+e._s(e.userInfo.signature?e.userInfo.signature:"暂未设置")+" ")],2)],1)],1),t("el-collapse-item",{attrs:{title:"学生认证",name:"2"}},[1===e.userInfo.status?[t("el-descriptions",{staticClass:"margin-top",attrs:{column:2,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 学号 ")]),e._v(" "+e._s(e.userInfo.student_info.id)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 学生姓名 ")]),e._v(" "+e._s(e.userInfo.student_info.name)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 学生性别 ")]),e._v(" "+e._s(0===e.userInfo.student_info.gender?"男":"女")+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 入学年份 ")]),e._v(" "+e._s(e.userInfo.student_info.attendance_year)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 学生院系 ")]),e._v(" "+e._s(e.getDepartNameById(e.userInfo.student_info.depart))+" ")],2)],1)]:[t("el-button",{attrs:{type:"primary"},on:{click:e.certificate}},[e._v("点击这里进行认证")])]],2)],1),t("Modal",{attrs:{title:"修改个人信息"},on:{"on-ok":e.updateUserInfo},model:{value:e.modalForUpdate,callback:function(t){e.modalForUpdate=t},expression:"modalForUpdate"}},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"邮箱",prop:"email",rules:e.rules.email}},[t("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email","string"===typeof t?t.trim():t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"个性签名",prop:"signature",rules:e.rules.signature}},[t("el-input",{model:{value:e.form.signature,callback:function(t){e.$set(e.form,"signature","string"===typeof t?t.trim():t)},expression:"form.signature"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"phone_no",rules:e.rules.phone_no}},[t("el-input",{model:{value:e.form.phone_no,callback:function(t){e.$set(e.form,"phone_no","string"===typeof t?t.trim():t)},expression:"form.phone_no"}})],1)],1)],1)],1)},s=[],n=a("d18b"),r=a("da3e"),i=a("56c3"),o=(a("919b"),a("0092"),a("f693"),a("b141"),a("7736")),u=a("cc32"),c=a("365c"),f=a("c276"),m={name:"user-details",computed:Object(i["a"])(Object(i["a"])({},Object(o["e"])("d2admin/user",{auth:"info"})),{},{headImg:function(){return null==this.userInfo.image_url?"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png":this.userInfo.image_url}}),data:function(){return{token:f["a"].cookies.get("token"),drawer:!1,modalForUpdate:!1,userInfo:{},form:{phone_no:"",email:"",signature:""},rules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:this.checkEmail,trigger:"blur"}],signature:[{}],phone_no:[{validator:this.checkPhoneNo,trigger:"blur"}]}}},methods:{formatTime:f["a"].time.formatTime,getDepartNameById:u["b"],getUserInfo:function(){var e=this;c["a"].GET_USER_INFO(this.auth.id).then((function(t){console.log(t),e.userInfo=t})).catch((function(e){console.log(e)}))},openFormForUpdate:function(){this.modalForUpdate=!0,this.form.nickname=this.userInfo.nickname,this.form.email=this.userInfo.email,this.form.signature=null===this.userInfo.signature?"":this.userInfo.signature,this.form.phone_no=null===this.userInfo.phone_no?"":this.userInfo.phone_no},checkEmail:function(e,t,a){var l=/^[a-zA-Z0-9]+([-_.][A-Za-zd]+)*@([a-zA-Z0-9]+[-.])+[A-Za-zd]{2,5}$/;l.test(t)?a():a(new Error("邮箱格式不合法"))},checkPhoneNo:function(e,t,a){0===t.length&&a();var l=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;l.test(t)?a():a(new Error("手机号格式不合法"))},updateUserInfo:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=!0,e.$refs.form.validate((function(e){a=e})),a){t.next=5;break}return e.$Message.error("表单输入不合法"),t.abrupt("return");case 5:return t.next=7,c["a"].UPDATE_USER_INFO(e.userInfo.id,e.form);case 7:return t.next=9,e.getUserInfo();case 9:e.$Message.success("修改成功！");case 10:case"end":return t.stop()}}),t)})))()},certificate:function(){this.$router.push({name:"user-certificate"})},handleUploadSuccess:function(e,t){var a=this;return Object(r["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].SET_USER_HEAD_IMG(e.id);case 2:return t.next=4,c["a"].DOWNLOAD_IMAGE(e.id);case 4:a.$store.state.d2admin.user.info.headImg=t.sent,a.$Message.success("上传成功！"),a.getUserInfo();case 7:case"end":return t.stop()}}),t)})))()},handleUploadError:function(e,t){this.$Message.error("上传失败！")},beforeImageUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return t||this.$Message.error("上传图片只能是 JPG/PNG 格式!"),a||this.$Message.error("上传图片大小不能超过 2MB!"),t&&a}},mounted:function(){this.getUserInfo()}},p=m,b=a("e607"),d=Object(b["a"])(p,l,s,!1,null,"4cd80fa3",null);t["default"]=d.exports},ab15:function(e,t,a){var l=a("ea8a").PROPER,s=a("2ab8"),n=a("7efc"),r="​᠎";e.exports=function(e){return s((function(){return!!n[e]()||r[e]()!==r||l&&n[e].name!==e}))}},cc32:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));a("f7e8");var l=[{value:1,label:"材料科学与工程学院"},{value:2,label:"电子信息工程学院"},{value:3,label:"自动化科学与电器工程学院"},{value:4,label:"能源与动力工程学院"},{value:5,label:"航空科学与工程学院"},{value:6,label:"计算机学院"},{value:7,label:"机械工程及自动化学院"},{value:8,label:"经济管理学院"},{value:9,label:"数学科学学院"},{value:10,label:"生物与医学工程学院"},{value:11,label:"人文社会科学学院"},{value:12,label:"外国语学院"},{value:13,label:"交通科学与工程学院"},{value:14,label:"可靠性与系统工程学院"},{value:15,label:"宇航学院"},{value:16,label:"飞行学院"},{value:17,label:"仪器科学与光电学院"},{value:18,label:"北京学院"},{value:19,label:"物理学院"},{value:20,label:"法学院"},{value:21,label:"软件学院"},{value:23,label:"高等理工学院"},{value:24,label:"中法工程师学院"},{value:25,label:"国际学院"},{value:26,label:"新媒体艺术与设计学院"},{value:27,label:"化学学院"},{value:28,label:"马克思主义学院"},{value:29,label:"人文与社会科学高等研究院"},{value:30,label:"空间与环境学院"},{value:31,label:"无人系统研究院"},{value:32,label:"航空发动机学院"},{value:35,label:"国际通用工程学院"},{value:37,label:"北航学院"},{value:71,label:"传源书院"},{value:73,label:"士谔书院"},{value:74,label:"冯如书院"},{value:75,label:"士嘉书院"},{value:76,label:"守谔书院"},{value:77,label:"致真书院"},{value:79,label:"知行书院"},{value:38,label:"医学科学与工程学院"},{value:39,label:"网络空间安全学院"},{value:41,label:"集成电路科学与工程学院"},{value:42,label:"人工智能研究院"},{value:43,label:"前沿科学技术创新研究院"}],s=function(e){var t="";return l.forEach((function(a,l){a.value===e&&(t=a.label)})),t}}}]);