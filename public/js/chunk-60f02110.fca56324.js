(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60f02110"],{"5f3b":function(e,t,r){"use strict";var a=r("aea8"),o=r("cde5").trim,i=r("ab15");a({target:"String",proto:!0,forced:i("trim")},{trim:function(){return o(this)}})},7608:function(e,t,r){"use strict";r.r(t);r("2482"),r("5f3b"),r("2445"),r("89b9");var a=function(){var e=this,t=e._self._c;return t("d2-container",{scopedSlots:e._u([{key:"header",fn:function(){return[t("el-steps",{attrs:{space:200,active:e.curStep,"finish-status":"success","align-center":""}},[t("el-step",{attrs:{title:"基本信息"}}),t("el-step",{attrs:{title:"商品参数"}}),t("el-step",{attrs:{title:"商品图片"}}),t("el-step",{attrs:{title:"商品介绍"}})],1)]},proxy:!0}])},[t("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":e.handleTabChange}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[t("el-form",{ref:"form1",staticStyle:{width:"80%","margin-left":"20px"},attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"商品名称",prop:"name",rules:e.rules.name}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"商品价格",prop:"price",rules:e.rules.price}},[t("el-input",{model:{value:e.form.price,callback:function(t){e.$set(e.form,"price","string"===typeof t?t.trim():t)},expression:"form.price"}})],1),t("el-form-item",{attrs:{label:"商品总量",prop:"total",rules:e.rules.total}},[t("el-input",{model:{value:e.form.total,callback:function(t){e.$set(e.form,"total","string"===typeof t?t.trim():t)},expression:"form.total"}})],1),t("el-form-item",{attrs:{label:"交易方式",prop:"method",rules:e.rules.method}},[t("el-radio",{attrs:{label:0},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}},[e._v("线上交易")]),t("el-radio",{attrs:{label:1},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}},[e._v("线下自取")]),t("el-radio",{attrs:{label:2},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}},[e._v("送货上门")])],1),t("el-form-item",{attrs:{label:"商品状态",prop:"status",rules:e.rules.status}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[t("el-option",{attrs:{label:"未生效",value:0}}),t("el-option",{attrs:{label:"预售中",value:1}}),t("el-option",{attrs:{label:"售卖中",value:2}})],1)],1)],1)],1),t("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},[t("el-form",{ref:"form2",staticStyle:{width:"80%","margin-left":"20px"},attrs:{model:e.form,"label-width":"80px"}},[e._l(e.form.params,(function(r,a){return t("div",{key:a},[t("el-form-item",{attrs:{label:"参数名",prop:"params."+a+".name",rules:e.rules.paraName}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入参数名"},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"para.name"}}),t("a",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.deletePara(a)}}})],1),t("el-form-item",{attrs:{label:"可选项",required:""}},e._l(r.options,(function(r,o){return t("row",{key:o,staticStyle:{"margin-bottom":"22px"}},[t("el-form-item",{attrs:{prop:"params."+a+".options."+o+".description",rules:e.rules.optionName}},[t("el-input",{staticStyle:{width:"130px","margin-right":"10px"},attrs:{placeholder:"请输入选项名称"},model:{value:r.description,callback:function(t){e.$set(r,"description",t)},expression:"option.description"}})],1),t("el-form-item",{attrs:{prop:"params."+a+".options."+o+".add",rules:e.rules.optionAdd}},[t("el-input",{staticStyle:{width:"130px"},attrs:{placeholder:"请输入价格增量"},model:{value:r.add,callback:function(t){e.$set(r,"add",t)},expression:"option.add"}})],1),1!==e.form.params[a].options.length?t("a",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"10px","margin-top":"12px"},on:{click:function(t){return e.deleteOption(a,o)}}}):e._e(),o===e.form.params[a].options.length-1?t("a",{staticClass:"el-icon-plus",staticStyle:{"margin-left":"10px","margin-top":"12px"},on:{click:function(t){return e.addOption(a)}}}):e._e()],1)})),1),t("hr",{staticStyle:{"margin-bottom":"20px"}})],1)})),t("el-button",{attrs:{type:"primary"},on:{click:e.addPara}},[e._v(" 增加参数 ")])],2)],1),t("el-tab-pane",{attrs:{label:"商品图片",name:"2"}},[t("el-form",{ref:"form3",staticStyle:{width:"80%","margin-left":"20px"},attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"上传图片",prop:"image_id",rules:e.rules.image}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/images","list-type":"picture",headers:{Authorization:"Bearer "+e.token},"on-success":e.handleUploadSuccess,"before-upload":e.beforeImageUpload,"file-list":[]}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],1)],1),t("el-tab-pane",{attrs:{label:"商品介绍",name:"3"}},[t("el-form",{ref:"form4",staticStyle:{width:"80%","margin-left":"20px"},attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"商品介绍",prop:"introduction",rules:e.rules.introduction}},[t("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入内容"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction","string"===typeof t?t.trim():t)},expression:"form.introduction"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")])],1)],1)],1)],1)],1)},o=[],i=r("d18b"),l=r("da3e"),s=(r("b141"),r("f7e8"),r("6657"),r("dc52"),r("5652"),r("dd35"),r("ae26"),r("919b"),r("0092"),r("f693"),r("c276")),n=r("365c"),m={name:"commodity-create",data:function(){return{curStep:0,curShopId:0,imageUrl:"",token:s["a"].cookies.get("token"),form:{name:"",total:"",price:"",method:0,introduction:"",status:2,image_id:[],params:[]},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"},{validator:this.checkPrice,trigger:"blur"}],total:[{required:!0,message:"请输入商品总量",trigger:"blur"},{validator:this.checkTotal,trigger:"blur"}],method:[{required:!0,message:"请输入交易方式",trigger:"blur"}],status:[{required:!0,message:"请输入商品状态",trigger:"blur"}],paraName:[{required:!0,message:"参数名不能为空",trigger:"blur"}],optionName:[{required:!0,message:"选项名称不能为空",trigger:"blur"}],optionAdd:[{required:!0,message:"价格增量不能为空",trigger:"blur"},{validator:this.checkPrice,trigger:"blur"}],image:[{required:!0,message:"图片不能为空",trigger:"blur"}],introduction:[{required:!0,message:"商品介绍不能为空",trigger:"blur"}]}}},methods:{onSubmit:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var r,a,o,l,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=!0,a=0,o=["form1","form2","form3","form4"];a<o.length;a++)l=o[a],e.$refs[l].validate((function(e){r&=e}));return r||e.$Message.error("表单输入不合法！"),console.log(e.form),t.next=6,n["a"].ADD_COMMODITY(e.curShopId,e.form);case 6:return s=t.sent,console.log(s),e.$Message.success("创建成功！"),t.next=11,e.$router.push({path:"/shop/goods"});case 11:case"end":return t.stop()}}),t)})))()},handleUploadSuccess:function(e,t){null!==e.id&&(this.imageUrl=URL.createObjectURL(t.raw),this.form.image_id.push(e.id),console.log(this.form.image_id))},handleTabChange:function(e,t){this.curStep=parseInt(e.name)},addPara:function(){this.form.params.push({name:"",options:[{description:"",price:""}]})},deletePara:function(e){this.form.params=this.form.params.filter((function(t,r){return r!==e}))},addOption:function(e){this.form.params[e].options.push({description:"",add:""})},deleteOption:function(e,t){this.form.params[e].options=this.form.params[e].options.filter((function(e,r){return r!==t}))},checkPrice:function(e,t,r){var a=/^(-)?[0-9]+([.][0-9]{0,2})?$/;a.test(t)?r():r(new Error("输入数字不合法（必须为整数、1位小数或2位小数）"))},checkTotal:function(e,t,r){var a=/^[0-9]+$/;a.test(t)?r():r(new Error("必须输入整数"))},beforeImageUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,r=e.size/1024/1024<2;return t||this.$Message.error("上传图片只能是 JPG/PNG 格式!"),r||this.$Message.error("上传图片大小不能超过 2MB!"),t&&r}},mounted:function(){this.curShopId=this.$route.query.shopId}},c=m,p=r("e607"),u=Object(p["a"])(c,a,o,!1,null,"28fe9588",null);t["default"]=u.exports},ab15:function(e,t,r){var a=r("ea8a").PROPER,o=r("2ab8"),i=r("7efc"),l="​᠎";e.exports=function(e){return o((function(){return!!i[e]()||l[e]()!==l||a&&i[e].name!==e}))}}}]);